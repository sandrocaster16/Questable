# Questable

Веб-платформа для создания и прохождения интерактивных городских квестов. Проект построен на фреймворке Yii2 и полностью запускается в Docker-контейнерах, что обеспечивает идентичное окружение для всех разработчиков.

## 1. Быстрый старт (Первый запуск)

### Требования

*   [Git](https://git-scm.com/downloads)
*   [Docker](https://docs.docker.com/get-docker/) и [Docker Compose](https://docs.docker.com/compose/install/)

### Пошаговая установка

1.  **Клонируйте репозиторий:**
    ```bash
    git clone [адрес_репозитория]
    cd Qustable
    ```

2.  **Создайте локальный файл конфигурации:**
    Этот файл содержит все секреты и настройки для вашего локального окружения. Он создается из шаблона `.env.example`.
    ```bash
    cp .env.example .env
    ```
    > **Примечание:** Для работы вам надо будет заполнить ```.env``` самостоятельно (спросите у главного разработчика).

3.  **Соберите и запустите контейнеры:**
    Эта команда скачает всё необходимое, соберет образ вашего приложения и запустит все сервисы (сайт, базу данных, phpMyAdmin) в фоновом режиме.
    ```bash
    docker-compose up -d --build
    ```

4.  **Установите PHP-зависимости:**
    Эта команда выполняется внутри уже запущенного контейнера `app` и создает папку `vendor` со всеми необходимыми библиотеками.
    ```bash
    docker-compose exec app composer install
    ```

5.  **Примените миграции базы данных:**
    Эта команда создаст все таблицы (для системы ролей, пользователей и т.д.) в базе данных.
    ```bash
    docker-compose exec app php yii migrate
    ```
    Когда система спросит `Apply the above migration?`, введите `yes` и нажмите Enter.

**Готово! Проект полностью настроен и запущен.**

*   **Сайт доступен по адресу:** [http://localhost:30013](http://localhost:30013)
*   **phpMyAdmin (для управления БД):** [http://localhost:8891](http://localhost:8891)
    *   **Сервер:** `mysql`
    *   **Пользователь:** `questable_user` (из вашего `.env` файла)
    *   **Пароль:** `secret` (из вашего `.env` файла)

## 2. Основные команды для ежедневной работы

### Управление Docker-контейнерами

*   **Запустить проект** (если он был остановлен):
    ```bash
    docker-compose up -d
    ```

*   **Остановить проект:**
    ```bash
    docker-compose down
    ```

*   **Полностью сбросить окружение** (остановить контейнеры и удалить данные БД):
    ```bash
    docker-compose down -v
    ```

*   **Посмотреть логи** работающего приложения в реальном времени (очень полезно для отладки):
    ```bash
    docker-compose logs -f app
    ```

### Выполнение команд внутри контейнера

Все консольные команды (Yii, Composer) выполняются с помощью префикса `docker-compose exec app`.

*   **Создать новую миграцию:**
    ```bash
    docker-compose exec app php yii migrate/create <название_миграции>
    ```

*   **Применить новые миграции:**
    ```bash
    docker-compose exec app php yii migrate
    ```

*   **Обновить зависимости Composer:**
    ```bash
    docker-compose exec app composer update
    ```
*   **Зайти в командную строку контейнера** (для выполнения произвольных команд):
    ```bash
    docker-compose exec app bash
    ```

## 3. Структура проекта

Проект состоит из двух основных частей: конфигурации Docker-окружения и самого Yii2-приложения.

```
.
├── app/                 # Корневая директория Yii2-приложения. Вся логика здесь.
│   ├── composer.json    # Список PHP-зависимостей приложения.
│   ├── composer.lock    # "Замороженные" версии зависимостей (гарантирует, что у всех они одинаковые).
│   ├── config/          # Конфигурационные файлы (база данных, веб, консоль).
│   ├── controllers/     # Контроллеры.
│   ├── migrations/      # Миграции базы данных (инструкции по изменению структуры БД).
│   ├── models/          # Модели.
│   ├── tests/           # Автоматические тесты.
│   ├── views/           # Представления (HTML).
│   └── web/             # Веб-рут (точка входа index.php, публичные ассеты CSS, JS).
│
├── system/              # Файлы для Docker-окружения.
│   └── Dockerfile       # "Рецепт" для сборки нашего PHP-контейнера.
│
├── .env                 # (Игнорируется Git) Ваши локальные переменные (пароли, ключи).
├── .env.example         # Шаблон для `.env` файла. Хранится в Git.
├── .gitignore           # Список файлов и папок, которые игнорируются Git (vendor, runtime и т.д.).
└── docker-compose.yml   # "Дирижёр" всего проекта. Описывает, как запускать все сервисы вместе.
```